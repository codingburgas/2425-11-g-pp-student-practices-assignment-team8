{% extends "base.html" %}
{% block title %}{{ club.name }}{% endblock %}

{% block content %}
  <div class="container my-5">
    <div class="card bg-black text-white p-4">
      <h2 class="mb-3">{{ club.name }}</h2>
      <p><strong>Head Teacher:</strong> {{ club.teacher }}</p>
      <p>{{ club.description }}</p>
      <p>
        <strong>Participants:</strong>
        <span id="participant-count">0</span> / 25
      </p>
      <button id="join-btn" class="btn btn-outline-primary mb-3">Join Club</button>
      <a href="{{ url_for('main_bp.index') }}" class="btn btn-outline-primary">Back to Clubs</a>
    </div>
  </div>

  <script>
document.addEventListener("DOMContentLoaded", () => {
    const joinBtn = document.getElementById("join-btn");

    joinBtn.addEventListener("click", () => {
        fetch('{{ url_for("main_bp.join_club") }}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                club_name: '{{ club.name }}'
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Request sent successfully!');
                joinBtn.disabled = true;
                joinBtn.textContent = 'Request Pending';
            } else {
                alert(data.message);
            }
        });
    });
});
</script>

{% endblock %}
